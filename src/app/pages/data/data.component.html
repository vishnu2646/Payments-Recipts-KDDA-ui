<div class="container">
    <div class="header">
        <h2>Income / Expense Data</h2>
        <mat-form-field appearance="outline">
            <mat-label>Data Type</mat-label>
            <mat-select [(value)]="selectedType" (selectionChange)="handleFormTypeChange($event)">
                @for (type of formType; track type) {
                    <mat-option [value]="type">{{ type }}</mat-option>
                }
            </mat-select>
        </mat-form-field>
    </div>
    <div class="table-data-wrapper">
        <ng-container *ngIf="selectedType === 'Income'; else expenseTemplate">
            <h2>Income Data</h2>
            <mat-form-field appearance="outline">
                <mat-label>Filter</mat-label>
                <input matInput placeholder="Enter Filter value" #input (keyup)="applyIncomeFilter($event)">
            </mat-form-field>

            <ng-container *ngIf="isIncomeLoading; else incomeTable">
                <p>Loading...</p>
            </ng-container>
            <ng-template #incomeTable>
                <div class="mat-elevation-z8 income-data-table">
                    <table mat-table [dataSource]="incomeDataSource">

                        <ng-container matColumnDef="incid">
                            <th mat-header-cell *matHeaderCellDef> Income ID </th>
                            <td mat-cell *matCellDef="let row" [routerLink]="['/receipt', row.incid]" style="cursor: pointer;"> {{ row.incid }} </td>
                        </ng-container>

                        <ng-container matColumnDef="income_name">
                            <th mat-header-cell *matHeaderCellDef> Income Name </th>
                            <td mat-cell *matCellDef="let row" (click)="handleRouteUpdateIncome(row.incid)" style="cursor: pointer;"> {{ row.income_name }} </td>
                        </ng-container>

                        <ng-container matColumnDef="amount">
                            <th mat-header-cell *matHeaderCellDef> Amount </th>
                            <td mat-cell *matCellDef="let row"> {{ row.amount }} </td>
                        </ng-container>

                        <ng-container matColumnDef="date">
                            <th mat-header-cell *matHeaderCellDef> Income Date </th>
                            <td mat-cell *matCellDef="let row"> {{ row.date }} </td>
                        </ng-container>

                        <ng-container matColumnDef="mode">
                            <th mat-header-cell *matHeaderCellDef> Income Mode </th>
                            <td mat-cell *matCellDef="let row"> {{ row.mode }} </td>
                        </ng-container>

                        <ng-container matColumnDef="reason">
                            <th mat-header-cell *matHeaderCellDef> Income Reason </th>
                            <td mat-cell *matCellDef="let row"> {{ row.reason }} </td>
                        </ng-container>

                        <ng-container matColumnDef="income_by">
                            <th mat-header-cell *matHeaderCellDef> Income By </th>
                            <td mat-cell *matCellDef="let row"> {{ row.income_by }} </td>
                        </ng-container>

                        <ng-container matColumnDef="details">
                            <th mat-header-cell *matHeaderCellDef> Income Details </th>
                            <td mat-cell *matCellDef="let row"> {{ row.details }} </td>
                        </ng-container>

                        <ng-container matColumnDef="bankname">
                            <th mat-header-cell *matHeaderCellDef> Bank Name </th>
                            <td mat-cell *matCellDef="let row"> {{ row.bankname }} </td>
                        </ng-container>

                        <ng-container matColumnDef="chequeordd">
                            <th mat-header-cell *matHeaderCellDef> Cheque or DD No </th>
                            <td mat-cell *matCellDef="let row"> {{ row.chequeordd }} </td>
                        </ng-container>

                        <ng-container matColumnDef="dateinbank">
                            <th mat-header-cell *matHeaderCellDef> Date in Bank </th>
                            <td mat-cell *matCellDef="let row"> {{ row.dateinbank }} </td>
                        </ng-container>

                        <ng-container matColumnDef="Action">
                            <th mat-header-cell *matHeaderCellDef> Action </th>
                            <td mat-cell *matCellDef="let row">
                                <mat-icon color="danger" (click)="handleDeleteIncome(row.incid)">delete</mat-icon>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayIncomeColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayIncomeColumns;"></tr>
                    </table>
                </div>
            </ng-template>
        </ng-container>
        <ng-template #expenseTemplate>
            <h2>Expense Data</h2>
            <mat-form-field appearance="outline">
                <mat-label>Filter</mat-label>
                <input matInput placeholder="Enter Filter value" #input (keyup)="applyExpenseFilter($event)">
            </mat-form-field>

            <ng-container *ngIf="isExpenseLoading; else expeneTemplate">
                <p>Loading...</p>
            </ng-container>
            <ng-template #expeneTemplate>

                <div class="mat-elevation-z8 income-data-table">
                    <table mat-table [dataSource]="expenseDataSource">

                        <ng-container matColumnDef="expid">
                            <th mat-header-cell *matHeaderCellDef> Expense ID </th>
                            <td mat-cell *matCellDef="let row" [routerLink]="['/voucher', row.expid]" style="cursor: pointer;"> {{ row.expid }} </td>
                        </ng-container>

                        <ng-container matColumnDef="expense_name">
                            <th mat-header-cell *matHeaderCellDef> Expense Name </th>
                            <td mat-cell *matCellDef="let row" (click)="handleRouteUpdateExpense(row.expid)" style="cursor: pointer;"> {{ row.expense_name }} </td>
                        </ng-container>

                        <ng-container matColumnDef="amount">
                            <th mat-header-cell *matHeaderCellDef> Amount </th>
                            <td mat-cell *matCellDef="let row"> {{ row.amount }} </td>
                        </ng-container>

                        <ng-container matColumnDef="date">
                            <th mat-header-cell *matHeaderCellDef> Expense Date </th>
                            <td mat-cell *matCellDef="let row"> {{ row.date }} </td>
                        </ng-container>

                        <ng-container matColumnDef="mode">
                            <th mat-header-cell *matHeaderCellDef> Expense Mode </th>
                            <td mat-cell *matCellDef="let row"> {{ row.mode }} </td>
                        </ng-container>

                        <ng-container matColumnDef="reason">
                            <th mat-header-cell *matHeaderCellDef> Expense Reason </th>
                            <td mat-cell *matCellDef="let row"> {{ row.reason }} </td>
                        </ng-container>

                        <ng-container matColumnDef="expense_by">
                            <th mat-header-cell *matHeaderCellDef> Expense By </th>
                            <td mat-cell *matCellDef="let row"> {{ row.expense_by }} </td>
                        </ng-container>

                        <ng-container matColumnDef="details">
                            <th mat-header-cell *matHeaderCellDef> Expense Details </th>
                            <td mat-cell *matCellDef="let row"> {{ row.details }} </td>
                        </ng-container>

                        <ng-container matColumnDef="bankname">
                            <th mat-header-cell *matHeaderCellDef> Bank Name </th>
                            <td mat-cell *matCellDef="let row"> {{ row.bankname }} </td>
                        </ng-container>

                        <ng-container matColumnDef="chequeordd">
                            <th mat-header-cell *matHeaderCellDef> Cheque or DD No </th>
                            <td mat-cell *matCellDef="let row"> {{ row.chequeordd }} </td>
                        </ng-container>

                        <ng-container matColumnDef="dateinbank">
                            <th mat-header-cell *matHeaderCellDef> Date in Bank </th>
                            <td mat-cell *matCellDef="let row"> {{ row.dateinbank }} </td>
                        </ng-container>

                        <ng-container matColumnDef="Action">
                            <th mat-header-cell *matHeaderCellDef> Action </th>
                            <td mat-cell *matCellDef="let row">
                                <mat-icon color="danger" (click)="handleDeleteExpense(row.expid)">delete</mat-icon>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayExpenseColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayExpenseColumns;"></tr>
                    </table>
                </div>
            </ng-template>
        </ng-template>
    </div>
</div>
